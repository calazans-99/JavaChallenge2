<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragmentos :: cabecalho('Sensores')}"></head>
<body class="container mt-4">
<form th:replace="~{fragmentos :: form-logout}"></form>

<div th:replace="~{fragmentos :: page-header('Sensores', @{/index})}"></div>
<div th:replace="~{fragmentos :: alerts}"></div>

<div class="d-flex justify-content-between align-items-center mb-3">
    <a class="btn btn-success" th:href="@{/sensores/new}">+ Novo Sensor</a>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover align-middle shadow-sm">
        <thead class="table-dark">
        <tr>
            <th>ID</th><th>Tipo</th><th>Status</th><th>Pátio</th><th>Pos. X</th><th>Pos. Y</th><th style="width:260px">Ações</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="s : ${sensores}">
            <td th:text="${s.id}">1</td>
            <td th:text="${s.tipo}">PRESENCA</td>
            <td th:text="${s.status}">ATIVO</td>
            <td th:text="${s.patio != null ? s.patio.nome : '-'}">Pátio 1</td>
            <td th:text="${s.posX}">0</td>
            <td th:text="${s.posY}">0</td>
            <td class="d-flex gap-1 flex-wrap">
                <a class="btn btn-sm btn-outline-secondary" th:href="@{/sensores/{id}/edit(id=${s.id})}">Editar</a>

                <form th:action="@{/sensores/{id}/delete(id=${s.id})}" method="post" style="display:inline">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button class="btn btn-sm btn-outline-danger" onclick="return confirm('Excluir este sensor?')">Excluir</button>
                </form>

                <form th:action="@{/sensores/{id}/ocupar(id=${s.id})}" method="post" style="display:inline">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button class="btn btn-sm btn-success">Ocupar</button>
                </form>

                <form th:action="@{/sensores/{id}/liberar(id=${s.id})}" method="post" style="display:inline">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button class="btn btn-sm btn-warning">Liberar</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div th:replace="~{fragmentos :: rodape-scripts}"></div>
</body>
</html>
